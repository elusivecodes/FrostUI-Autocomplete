{"version":3,"names":["Autocomplete","BaseComponent","constructor","node","options","super","this","_data","_activeItems","_getData","_getResults","_options","getResults","_getResultsInit","data","_getDataInit","_render","_events","dispose","_popper","$","remove","_menuNode","removeEvent","_node","removeAttribute","_loader","_error","_value","_requests","_popperOptions","hide","isConnected","getDataset","triggerOne","setDataset","uiAnimating","fadeOut","duration","then","_","empty","detach","removeDataset","setAttribute","triggerEvent","catch","show","is","hasAttribute","term","getValue","appendTo","append","after","Popper","fadeIn","toggle","update","defaults","lang","error","loading","renderResult","value","sanitize","input","isMatch","escapedTerm","_escapeRegExp","regExp","RegExp","test","normalized","normalize","replace","sortResults","a","b","aLower","toLowerCase","bLower","diff","indexOf","localeCompare","minSearch","debounce","maxHeight","menuSize","fullWidth","placement","position","fixed","spacing","minContact","classes","active","focus","info","item","menu","menuSmall","menuLarge","proto","prototype","addEventDelegate","e","preventDefault","addEvent","isSame","document","activeElement","stop","currentTarget","setValue","focusedNode","findOne","removeClass","addClass","uiFocus","id","getAttribute","includes","code","stopPropagation","focusNode","focusIndex","_request","itemsScrollY","getScrollY","itemsRect","rect","offset","nodeRect","top","setScrollY","bottom","_throttle","_loadingScroll","_showMore","height","scrollHeight","boxSize","SCROLL_BOX","length","leading","bind","results","filter","sort","_renderResults","load","_debounce","request","Promise","resolve","response","newData","push","showMore","finally","cancel","children","lastChild","child","generateId","create","class","style","attributes","role","_renderInfo","reference","beforeUpdate","setStyle","width","afterUpdate","BORDER_BOX","text","html","_renderItem","element","dataset","uiAction","uiValue","content","_isString","setHTML","_isElement","hasChildren","initComponent"],"sources":["../src/js/autocomplete.js","../src/js/index.js","../src/js/prototype/events.js","../src/js/prototype/data.js","../src/js/prototype/render.js"],"sourcesContent":["import $ from '@fr0st/query';\nimport { BaseComponent, Popper } from '@fr0st/ui';\n\n/**\n * Autocomplete Class\n * @class\n */\nexport default class Autocomplete extends BaseComponent {\n    /**\n     * New Autocomplete constructor.\n     * @param {HTMLElement} node The input node.\n     * @param {object} [options] The options to create the Autocomplete with.\n     */\n    constructor(node, options) {\n        super(node, options);\n\n        this._data = [];\n        this._activeItems = [];\n\n        this._getData = null;\n        this._getResults = null;\n\n        if (this._options.getResults) {\n            this._getResultsInit();\n        } else if (this._options.data) {\n            this._data = this._options.data;\n            this._getDataInit();\n        }\n\n        this._render();\n        this._events();\n    }\n\n    /**\n     * Dispose the Autocomplete.\n     */\n    dispose() {\n        if (this._popper) {\n            this._popper.dispose();\n            this._popper = null;\n        }\n\n        $.remove(this._menuNode);\n        $.removeEvent(this._node, 'keydown.ui.autocomplete');\n        $.removeEvent(this._node, 'input.ui.autocomplete');\n        $.removeEvent(this._node, 'blur.ui.autocomplete');\n        $.removeAttribute(this._node, 'role');\n        $.removeAttribute(this._node, 'aria-controls');\n        $.removeAttribute(this._node, 'aria-autocomplete');\n        $.removeAttribute(this._node, 'aria-expanded');\n        $.removeAttribute(this._node, 'aria-activedescendent');\n\n        this._menuNode = null;\n        this._loader = null;\n        this._error = null;\n        this._data = null;\n        this._activeItems = null;\n        this._value = null;\n        this._requests = null;\n        this._popperOptions = null;\n        this._getData = null;\n\n        super.dispose();\n    }\n\n    /**\n     * Hide the Autocomplete.\n     */\n    hide() {\n        if (\n            !$.isConnected(this._menuNode) ||\n            $.getDataset(this._menuNode, 'uiAnimating') ||\n            !$.triggerOne(this._node, 'hide.ui.autocomplete')\n        ) {\n            return;\n        }\n\n        $.setDataset(this._menuNode, { uiAnimating: 'out' });\n\n        $.fadeOut(this._menuNode, {\n            duration: this._options.duration,\n        }).then((_) => {\n            this._popper.dispose();\n            this._popper = null;\n\n            this._activeItems = [];\n            $.empty(this._menuNode);\n            $.detach(this._menuNode);\n            $.removeDataset(this._menuNode, 'uiAnimating');\n            $.setAttribute(this._node, {\n                'aria-expanded': false,\n                'aria-activedescendent': '',\n            });\n            $.triggerEvent(this._node, 'hidden.ui.autocomplete');\n        }).catch((_) => {\n            if ($.getDataset(this._menuNode, 'uiAnimating') === 'out') {\n                $.removeDataset(this._menuNode, 'uiAnimating');\n            }\n        });\n    }\n\n    /**\n     * Show the Autocomplete.\n     */\n    show() {\n        if (\n            $.is(this._node, ':disabled') ||\n            $.hasAttribute(this._node, 'readonly') ||\n            $.isConnected(this._menuNode) ||\n            $.getDataset(this._menuNode, 'uiAnimating') ||\n            !$.triggerOne(this._node, 'show.ui.autocomplete')\n        ) {\n            return;\n        }\n\n        const term = $.getValue(this._node);\n        this._getData({ term });\n\n        $.setDataset(this._menuNode, { uiAnimating: 'in' });\n\n        if (this._options.appendTo) {\n            $.append(this._options.appendTo, this._menuNode);\n        } else {\n            $.after(this._node, this._menuNode);\n        }\n\n        this._popper = new Popper(this._menuNode, this._popperOptions);\n\n        $.fadeIn(this._menuNode, {\n            duration: this._options.duration,\n        }).then((_) => {\n            $.removeDataset(this._menuNode, 'uiAnimating');\n            $.setAttribute(this._node, { 'aria-expanded': true });\n            $.triggerEvent(this._node, 'shown.ui.autocomplete');\n        }).catch((_) => {\n            if ($.getDataset(this._menuNode, 'uiAnimating') === 'in') {\n                $.removeDataset(this._menuNode, 'uiAnimating');\n            }\n        });\n    }\n\n    /**\n     * Toggle the Autocomplete.\n     */\n    toggle() {\n        if ($.isConnected(this._menuNode)) {\n            this.hide();\n        } else {\n            this.show();\n        }\n    }\n\n    /**\n     * Update the Autocomplete position.\n     */\n    update() {\n        if (this._popper) {\n            this._popper.update();\n        }\n    }\n}\n","import $ from '@fr0st/query';\nimport { initComponent } from '@fr0st/ui';\nimport Autocomplete from './autocomplete.js';\nimport { _getDataInit, _getResultsInit } from './prototype/data.js';\nimport { _events } from './prototype/events.js';\nimport { _render, _renderInfo, _renderItem, _renderResults } from './prototype/render.js';\n\n// Autocomplete default options\nAutocomplete.defaults = {\n    lang: {\n        error: 'Error loading data.',\n        loading: 'Loading..',\n    },\n    data: null,\n    getResults: null,\n    renderResult: (value) => value,\n    sanitize: (input) => $.sanitize(input),\n    isMatch(value, term) {\n        const escapedTerm = $._escapeRegExp(term);\n        const regExp = new RegExp(escapedTerm, 'i');\n\n        if (regExp.test(value)) {\n            return true;\n        }\n\n        const normalized = value.normalize('NFD').replace(/[\\u0300-\\u036f]/g, '');\n\n        return regExp.test(normalized);\n    },\n    sortResults(a, b, term) {\n        const aLower = a.toLowerCase();\n        const bLower = b.toLowerCase();\n\n        if (term) {\n            const diff = aLower.indexOf(term) - bLower.indexOf(term);\n\n            if (diff) {\n                return diff;\n            }\n        }\n\n        return aLower.localeCompare(bLower);\n    },\n    minSearch: 1,\n    debounce: 250,\n    duration: 100,\n    maxHeight: '250px',\n    menuSize: null,\n    appendTo: null,\n    fullWidth: false,\n    placement: 'bottom',\n    position: 'start',\n    fixed: false,\n    spacing: 0,\n    minContact: false,\n};\n\n// Default classes\nAutocomplete.classes = {\n    active: 'active',\n    focus: 'focus',\n    info: 'autocomplete-item text-body-secondary',\n    item: 'autocomplete-item',\n    menu: 'autocomplete-menu list-unstyled',\n    menuSmall: 'autocomplete-menu-sm',\n    menuLarge: 'autocomplete-menu-lg',\n};\n\n// Autocomplete prototype\nconst proto = Autocomplete.prototype;\n\nproto._events = _events;\nproto._getDataInit = _getDataInit;\nproto._getResultsInit = _getResultsInit;\nproto._render = _render;\nproto._renderInfo = _renderInfo;\nproto._renderItem = _renderItem;\nproto._renderResults = _renderResults;\n\n// Autocomplete init\ninitComponent('autocomplete', Autocomplete);\n\nexport default Autocomplete;\n","import $ from '@fr0st/query';\n\n/**\n * Attach events for the Autocomplete.\n */\nexport function _events() {\n    $.addEventDelegate(this._menuNode, 'contextmenu.ui.autocomplete', '[data-ui-action=\"select\"]', (e) => {\n        // prevent menu node from showing right click menu\n        e.preventDefault();\n    });\n\n    $.addEventDelegate(this._menuNode, 'mousedown.ui.autocomplete', '[data-ui-action=\"select\"]', (e) => {\n        // prevent selection from triggering blur event\n        e.preventDefault();\n    });\n\n    $.addEvent(this._node, 'blur.ui.autocomplete', (_) => {\n        if ($.isSame(this._node, document.activeElement)) {\n            return;\n        }\n\n        $.stop(this._menuNode);\n        $.removeDataset(this._menuNode, 'uiAnimating');\n\n        this.hide();\n    });\n\n    $.addEventDelegate(this._menuNode, 'click.ui.autocomplete', '[data-ui-action=\"select\"]', (e) => {\n        e.preventDefault();\n\n        const value = $.getDataset(e.currentTarget, 'uiValue');\n\n        if (value !== $.getValue(this._node)) {\n            $.setValue(this._node, value);\n            $.triggerEvent(this._node, 'change.ui.autocomplete');\n        }\n\n        this.hide();\n        $.focus(this._node);\n    });\n\n    $.addEventDelegate(this._menuNode, 'mouseover.ui.autocomplete', '[data-ui-action=\"select\"]', $.debounce((e) => {\n        const focusedNode = $.findOne('[data-ui-focus]', this._menuNode);\n        $.removeClass(focusedNode, this.constructor.classes.focus);\n        $.removeDataset(focusedNode, 'uiFocus');\n\n        $.addClass(e.currentTarget, this.constructor.classes.focus);\n        $.setDataset(e.currentTarget, { uiFocus: true });\n\n        const id = $.getAttribute(e.currentTarget, 'id');\n        $.setAttribute(this._node, { 'aria-activedescendent': id });\n    }));\n\n    $.addEvent(this._node, 'input.ui.autocomplete', $.debounce((_) => {\n        if (!$.isConnected(this._menuNode)) {\n            this.show();\n        } else {\n            const term = $.getValue(this._node);\n            this._getData({ term });\n        }\n    }));\n\n    $.addEvent(this._node, 'keydown.ui.autocomplete', (e) => {\n        if (!['ArrowDown', 'ArrowUp', 'Enter', 'Escape', 'NumpadEnter'].includes(e.code)) {\n            return;\n        }\n\n        const focusedNode = $.findOne('[data-ui-focus]', this._menuNode);\n\n        switch (e.code) {\n            case 'Enter':\n            case 'NumpadEnter':\n                // select the focused item\n                if (focusedNode) {\n                    const value = $.getDataset(focusedNode, 'uiValue');\n\n                    if (value !== $.getValue(this._node)) {\n                        $.setValue(this._node, value);\n                        $.triggerEvent(this._node, 'change.ui.autocomplete');\n                    }\n\n                    this.hide();\n                }\n\n                return;\n            case 'Escape':\n                if ($.isConnected(this._menuNode)) {\n                    // prevent node from closing modal\n                    e.stopPropagation();\n\n                    this.hide();\n                }\n\n                return;\n        }\n\n        e.preventDefault();\n\n        if (!$.isConnected(this._menuNode)) {\n            this.show();\n            return;\n        }\n\n        // focus the previous/next item\n\n        let focusNode;\n        if (!focusedNode) {\n            focusNode = this._activeItems[0];\n        } else {\n            let focusIndex = this._activeItems.indexOf(focusedNode);\n\n            switch (e.code) {\n                case 'ArrowDown':\n                    focusIndex++;\n                    break;\n                case 'ArrowUp':\n                    focusIndex--;\n                    break;\n            }\n\n            focusNode = this._activeItems[focusIndex];\n        }\n\n        if (!focusedNode && !focusNode && !this._request) {\n            const term = $.getValue(this._node);\n            this._getData({ term });\n            return;\n        }\n\n        if (!focusNode) {\n            return;\n        }\n\n        $.removeClass(focusedNode, this.constructor.classes.focus);\n        $.removeDataset(focusedNode, 'uiFocus');\n        $.addClass(focusNode, this.constructor.classes.focus);\n        $.setDataset(focusNode, { uiFocus: true });\n\n        const id = $.getAttribute(focusNode, 'id');\n        $.setAttribute(this._node, { 'aria-activedescendent': id });\n\n        const itemsScrollY = $.getScrollY(this._menuNode);\n        const itemsRect = $.rect(this._menuNode, { offset: true });\n        const nodeRect = $.rect(focusNode, { offset: true });\n\n        if (nodeRect.top < itemsRect.top) {\n            $.setScrollY(this._menuNode, itemsScrollY + nodeRect.top - itemsRect.top);\n        } else if (nodeRect.bottom > itemsRect.bottom) {\n            $.setScrollY(this._menuNode, itemsScrollY + nodeRect.bottom - itemsRect.bottom);\n        }\n    });\n\n    if (this._options.getResults) {\n        // infinite scrolling event\n        $.addEvent(this._menuNode, 'scroll.ui.autocomplete', $._throttle((_) => {\n            if (this._loadingScroll || !this._showMore) {\n                return;\n            }\n\n            const height = $.height(this._menuNode);\n            const scrollHeight = $.height(this._menuNode, { boxSize: $.SCROLL_BOX });\n            const scrollTop = $.getScrollY(this._menuNode);\n\n            if (scrollTop >= scrollHeight - height - (height / 4)) {\n                const term = $.getValue(this._node);\n                const offset = this._data.length;\n\n                this._loadingScroll = true;\n                this._getData({ term, offset });\n            }\n        }, 250, { leading: false }));\n    }\n};\n","import $ from '@fr0st/query';\n\n/**\n * Initialize preloaded get data.\n */\nexport function _getDataInit() {\n    this._getData = ({ term = null }) => {\n        this._activeItems = [];\n        $.empty(this._menuNode);\n        $.setAttribute(this._node, { 'aria-activedescendent': '' });\n\n        // check for minimum search length\n        if (this._options.minSearch && (!term || term.length < this._options.minSearch)) {\n            $.hide(this._menuNode);\n            this.update();\n            return;\n        }\n\n        $.show(this._menuNode);\n\n        const isMatch = this._options.isMatch.bind(this);\n        const sortResults = this._options.sortResults.bind(this);\n\n        // filter results\n        const results = this._data.filter((value) => isMatch(value, term))\n            .sort((a, b) => sortResults(a, b, term));\n\n        this._renderResults(results);\n        this.update();\n    };\n};\n\n/**\n * Initialize get data from callback.\n */\nexport function _getResultsInit() {\n    const load = $._debounce(({ offset, term }) => {\n        const options = { offset };\n\n        if (term) {\n            options.term = term;\n        }\n\n        const request = Promise.resolve(this._options.getResults(options));\n\n        request.then((response) => {\n            if (this._request !== request) {\n                return;\n            }\n\n            const newData = response.results;\n\n            if (!offset) {\n                this._data = newData;\n                $.empty(this._menuNode);\n            } else {\n                this._data.push(...newData);\n                $.detach(this._loader);\n            }\n\n            this._showMore = response.showMore;\n\n            this._renderResults(newData);\n\n            this._request = null;\n        }).catch((_) => {\n            if (this._request !== request) {\n                return;\n            }\n\n            $.detach(this._loader);\n            $.append(this._menuNode, this._error);\n\n            this._request = null;\n        }).finally((_) => {\n            this._loadingScroll = false;\n            this.update();\n        });\n\n        this._request = request;\n    }, this._options.debounce);\n\n    this._getData = ({ offset = 0, term = null }) => {\n        // cancel last request\n        if (this._request && this._request.cancel) {\n            this._request.cancel();\n        }\n\n        this._request = null;\n\n        if (!offset) {\n            this._activeItems = [];\n            $.setAttribute(this._node, { 'aria-activedescendent': '' });\n\n            const children = $.children(this._menuNode, (node) => !$.isSame(node, this._loader));\n            $.detach(children);\n        } else {\n            $.detach(this._error);\n        }\n\n        // check for minimum search length\n        if (this._options.minSearch && (!term || term.length < this._options.minSearch)) {\n            $.hide(this._menuNode);\n            this.update();\n            return;\n        }\n\n        $.show(this._menuNode);\n\n        const lastChild = $.child(this._menuNode, ':last-child');\n        if (!lastChild || !$.isSame(lastChild, this._loader)) {\n            $.append(this._menuNode, this._loader);\n        }\n\n        load({ offset, term });\n    };\n};\n","import $ from '@fr0st/query';\nimport { generateId } from '@fr0st/ui';\n\n/**\n * Render the toggle element.\n */\nexport function _render() {\n    const id = generateId('autocomplete');\n\n    this._menuNode = $.create('ul', {\n        class: this.constructor.classes.menu,\n        style: { maxHeight: this._options.maxHeight },\n        attributes: {\n            id,\n            role: 'listbox',\n        },\n    });\n\n    if ($.is(this._node, '.input-sm')) {\n        $.addClass(this._menuNode, this.constructor.classes.menuSmall);\n    } else if ($.is(this._node, '.input-lg')) {\n        $.addClass(this._menuNode, this.constructor.classes.menuLarge);\n    }\n\n    if (this._options.getResults) {\n        this._loader = this._renderInfo(this._options.lang.loading);\n        this._error = this._renderInfo(this._options.lang.error);\n    }\n\n    this._popperOptions = {\n        reference: this._node,\n        placement: this._options.placement,\n        position: this._options.position,\n        fixed: this._options.fixed,\n        spacing: this._options.spacing,\n        minContact: this._options.minContact,\n    };\n\n    if (this._options.fullWidth) {\n        this._popperOptions.beforeUpdate = (node) => {\n            $.setStyle(node, { width: '' });\n        };\n\n        this._popperOptions.afterUpdate = (node, reference) => {\n            const width = $.width(reference, { boxSize: $.BORDER_BOX });\n            $.setStyle(node, { width: `${width}px` });\n        };\n    }\n\n    $.setAttribute(this._node, {\n        'role': 'combobox',\n        'aria-controls': id,\n        'aria-autocomplete': 'list',\n        'aria-expanded': false,\n        'aria-activedescendent': '',\n    });\n};\n\n/**\n * Render an information item.\n * @param {string} text The text to render.\n * @return {HTMLElement} The information item.\n */\nexport function _renderInfo(text) {\n    const element = $.create('div', {\n        html: this._options.sanitize(text),\n        class: this.constructor.classes.info,\n    });\n\n    return element;\n};\n\n/**\n * Render an item.\n * @param {string} value The value to render.\n * @return {HTMLElement} The item element.\n */\nexport function _renderItem(value) {\n    const id = generateId('autocomplete-item');\n\n    const active = $.getValue(this._node) == value;\n\n    const element = $.create('li', {\n        class: this.constructor.classes.item,\n        attributes: {\n            id,\n            'role': 'option',\n            'aria-label': value,\n            'aria-selected': active,\n        },\n        dataset: {\n            uiAction: 'select',\n            uiValue: value,\n        },\n    });\n\n    this._activeItems.push(element);\n\n    if (active) {\n        $.addClass(element, this.constructor.classes.active);\n    }\n\n    const content = this._options.renderResult.bind(this)(value, element);\n\n    if ($._isString(content)) {\n        $.setHTML(element, this._options.sanitize(content));\n    } else if ($._isElement(content) && !$.isSame(element, content)) {\n        $.append(element, content);\n    }\n\n    return element;\n};\n\n/**\n * Render results.\n * @param {array} results The results to render.\n */\nexport function _renderResults(results) {\n    $.show(this._menuNode);\n\n    for (const value of results) {\n        const element = this._renderItem(value);\n        $.append(this._menuNode, element);\n    }\n\n    if (!$.hasChildren(this._menuNode)) {\n        $.hide(this._menuNode);\n        return;\n    }\n\n    const focusedNode = $.findOne('[data-ui-focus]', this._menuNode);\n\n    if (!focusedNode && this._activeItems.length) {\n        const element = this._activeItems[0];\n        $.addClass(element, this.constructor.classes.focus);\n        $.setDataset(element, { uiFocus: true });\n\n        const id = $.getAttribute(element, 'id');\n        $.setAttribute(this._node, { 'aria-activedescendent': id });\n    }\n};\n"],"mappings":"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"}